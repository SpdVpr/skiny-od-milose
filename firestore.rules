rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper funkce pro validaci dat
    function isValidSkin(skin) {
      return skin.keys().hasAll(['assetId', 'name', 'wear', 'imageUrl', 'inInventory', 'isVisible', 'updatedAt'])
        && skin.assetId is string
        && skin.name is string
        && skin.wear is string
        && skin.imageUrl is string
        && skin.inInventory is bool
        && skin.isVisible is bool
        && skin.updatedAt is timestamp;
    }
    
    // Kolekce skins
    match /skins/{skinId} {
      // Čtení: Povolit všem pro vývoj (v produkci zvážit omezení na isVisible)
      allow read: if true;
      
      // Zápis: Povolit pro admin panel (v produkci zabezpečit!)
      allow write: if true;
    }

    // Kolekce settings (pro měnové kurzy)
    match /settings/{document=**} {
      allow read: if true;
      allow write: if false; // Zápis pouze admin přes konzoli nebo pokud přidáš auth pravidla
    }

    // Kolekce reviews
    match /reviews/{reviewId} {
      allow read: if true;
      allow write: if true;
    }
    
    // Defaultně zakázat vše ostatní
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

